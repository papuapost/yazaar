/** JavaScript Bubbling Library (c) MIT License 2007* http://bubbling.comarq.com/eng/licence* Free Support: http://bubbling.comarq.com/* V 2.2.0*/(function(){var $C=YAHOO.util.Connect,$E=YAHOO.util.Event,$D=YAHOO.util.Dom,$=YAHOO.util.Dom.get;YAHOO.util.Dispatcher=function(){var obj={},_threads={};function dispatch(hd,userConfig){if(obj.isAlive(hd)){var node=_threads[hd].shift();if(node.src){var callback={success:function(o){if(o.responseText!='undefined'){exec(hd,o.responseText,userConfig);}},failure:function(o){dispatch(hd,userConfig);}};var request=$C.asyncRequest('GET',node.src,callback);}else{exec(hd,node.content,userConfig);}}else{obj.kill(hd);if(userConfig.after)userConfig.after.call();}};function exec(hd,c,userConfig){if(c&&(c!='')){userConfig.scope=(userConfig.scope?userConfig.scope:window);try{this.scriptScope=null;this.scriptScope=new(new Function('_container_',c+'; return this;'))(userConfig.scope);}catch(e){alert("Error running scripts from content:\n"+e);}}dispatch(hd,userConfig);};function display(el,c,userConfig){userConfig.action=(userConfig.action?userConfig.action:'update');switch(userConfig.action){case'tabview':try{el.set('content',c);}catch(e){return false;}break;case'update':while(el.childNodes.length>0){$E.purgeElement(el.childNodes[0],true);el.removeChild(el.childNodes[0]);}c=el.innerHTML+c;default:try{el.innerHTML=c;}catch(e){return false;}break;}return true;};function parse(hd,s){var m=true,attr=false;while(m){m=false;s=s.replace(/<script([^>]*)>([\s\S]*?)<\/script>/i,function(str,p1,p2,offset,s){if(p1){attr=p1.match(/src=(['"]?)([^"']*)\1/i);if(attr){_threads[hd].push({src:attr[2],content:''});}}_threads[hd].push({src:null,content:p2});m=true;return"";});}return s;};obj.fetch=function(el,file,userConfig){if(file){userConfig=userConfig||{};var callback={success:function(o){if(o.responseText!='undefined'){obj.process(el,o.responseText,userConfig);}},failure:function(o){}};if(userConfig.before){userConfig.before.call();userConfig.before=null;}var request=$C.asyncRequest('GET',file,callback);}};obj.process=function(el,content,userConfig){var hd=null;userConfig=userConfig||{};if(el&&((typeof el=='object')||(el=$(el)))){var hd=userConfig.guid||$E.generateId(el);this.kill(hd);if(userConfig.before)userConfig.before.call();if(display(el,parse(hd,content),userConfig)){dispatch(hd,userConfig);}}return hd;};obj.isAlive=function(hd){return(hd&&(_threads[hd])&&(_threads[hd].length>0));};obj.kill=function(hd){if(this.isAlive(hd)){_threads[hd]=null;}_threads[hd]=[];};obj.delegate=function(tab,tabview,userConfig){userConfig=userConfig||{};userConfig.action='tabview';tab.loadHandler.success=function(o){obj.process(tab,o.responseText,userConfig);};if(tabview&&(typeof tabview=='object')){tabview.addTab(tab);}};return obj;}();})();